**当学习成为了习惯，知识也就变成了常识。** 感谢各位的 **关注**、**点赞**、**收藏**和**评论**。

新视频和文章会第一时间在微信公众号发送，欢迎关注：[李永宁lyn](https://gitee.com/liyongning/typora-image-bed/raw/master/202202171742614.jpg)

文章已收录到 [github 仓库 liyongning/blog](https://github.com/liyongning/blog)，欢迎 Watch 和 Star。

# 回顾

在开始之前，我们先回归一下上篇 [浏览器工作原理（1）— 多进程架构](baidu.com)，作为本系列的开篇，文章主要讲解了如下内容：

* 开头，讲了为什么会有本系列。一是为什么要深入了解浏览器？二是浏览器方面的知识都是零零散散的，三是本系列也相当于自己学习的一个记录（笔记）
* 第二部分讲了浏览器的四个发展阶段，从单进程架构 -> 早期多进程架构 -> 成熟的多进程架构 -> 多进程架构 + 模块服务化。每一次迭代都是为了解决特定的问题，让用户体验更好
* 基于问题 —— **Chrome 打开一个页面需要启动多少个进程**，讲了如何计算浏览器中的进程数。顺带讲了浏览上下文组、跨站、跨域的相关概念

上篇从宏观层面讲解了浏览器架构相关的知识，本篇我们会详细讲解**浏览器中的网络知识**。

# FP (First Paint)

在衡量 Web 性能的时候有一个重要指标叫 **FP (First Paint)**，指标的意思是指页面从开始加载到首个像素绘制的时间。这个指标的好坏直接影响着页面的跳出率，因为更快的页面响应速度意味着更多的 PV、更多的用户参与度，而网络加载速度是影响 FP 指标的一大重要因素。因此，如果我们要优化页面的加载速度，就需要对浏览器中的网络知识有一个清晰而深刻的理解。

# 浏览器中的网络请求

图中所示是浏览器中一个完整的 HTTP 请求的过程，大致会分为三个环节：

* 我们在浏览器发起请求后，浏览器首先会进行缓存查找，试图从缓存中获取结果，如果命中缓存，则直接返回结果，否则就开始准备和服务器建立连接从服务器获取数据。
* 建立连接之前，首先需要获取到服务器的 IP 地址和端口号，从而建立 TCP 连接，如果是 HTTPS 协议，还会建立 TLS 连接。
* 和服务器建立连接之后，接下来就会向服务器发送 HTTP 请求，待服务器完成处理后返回结果，并断开连接

![image-20240328172833960](https://raw.githubusercontent.com/liyongning/picture-bed/master/liyongning/202403281728068.png)

## 浏览器缓存

首先，明确一点，浏览器的缓存行为由 Web 服务器控制，比如 nginx、apache 等。浏览器缓存分为强缓存和弱缓存



